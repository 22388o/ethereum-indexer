TODO: implement graceful exit to avoid data corruption